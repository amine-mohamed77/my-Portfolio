<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Loader - Portfolio</title>
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r150/three.min.js"></script>
    
    <style>
        :root {
            /* Customizable Properties */
            --loader-color: #3b82f6;
            --loader-accent: #8b5cf6;
            --loader-rotation-speed: 1;
            --loader-metalness: 0.8;
            --loader-roughness: 0.2;
            --bg-gradient-from: #0f172a;
            --bg-gradient-to: #1e293b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow: hidden;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        /* Loading Screen */
        #loading-screen {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: linear-gradient(135deg, var(--bg-gradient-from), var(--bg-gradient-to));
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
        }
        
        #loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        /* 3D Canvas Container */
        #loader-canvas-container {
            position: relative;
            width: 400px;
            height: 400px;
            max-width: 90vw;
            max-height: 90vh;
        }
        
        #loader-canvas {
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        /* Glow Effect */
        .loader-glow {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle, var(--loader-color) 0%, transparent 70%);
            opacity: 0.3;
            filter: blur(60px);
            animation: pulse-glow 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.1); }
        }
        
        /* Loading Text */
        .loading-text {
            position: absolute;
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            opacity: 0.9;
        }
        
        .loading-dots {
            display: inline-block;
            width: 20px;
        }
        
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        /* Progress Bar */
        .progress-container {
            position: absolute;
            bottom: -120px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            max-width: 80vw;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--loader-color), var(--loader-accent));
            border-radius: 2px;
            transition: width 0.3s ease-out;
            box-shadow: 0 0 20px var(--loader-color);
        }
        
        /* Percentage */
        .progress-percentage {
            position: absolute;
            bottom: -150px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Mobile Optimization */
        @media (max-width: 640px) {
            #loader-canvas-container {
                width: 300px;
                height: 300px;
            }
            
            .loading-text {
                font-size: 1rem;
                bottom: -60px;
            }
            
            .progress-container {
                bottom: -100px;
                width: 250px;
            }
            
            .progress-percentage {
                bottom: -130px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div id="loader-canvas-container">
            <!-- Glow Effect -->
            <div class="loader-glow"></div>
            
            <!-- 3D Canvas -->
            <canvas id="loader-canvas"></canvas>
            
            <!-- Loading Text -->
            <div class="loading-text">
                Loading<span class="loading-dots"></span>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
            </div>
            
            <!-- Percentage -->
            <div class="progress-percentage" id="progress-percentage">0%</div>
        </div>
    </div>

    <!-- Main Content (Hidden until loaded) -->
    <div id="main-content" style="display: none;">
        <div class="min-h-screen bg-gray-900 text-white flex items-center justify-center">
            <div class="text-center">
                <h1 class="text-6xl font-bold mb-4">Welcome!</h1>
                <p class="text-xl text-gray-400">Your portfolio has loaded successfully.</p>
            </div>
        </div>
    </div>

    <!-- 3D Loader Script -->
    <script>
        // Configuration
        const CONFIG = {
            colorHex: getComputedStyle(document.documentElement).getPropertyValue('--loader-color').trim(),
            accentColor: getComputedStyle(document.documentElement).getPropertyValue('--loader-accent').trim(),
            rotationSpeed: parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--loader-rotation-speed')) || 1,
            metalness: parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--loader-metalness')) || 0.8,
            roughness: parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--loader-roughness')) || 0.2,
            autoHideDelay: 2000, // Hide after 2 seconds (simulated loading)
            minLoadTime: 1500, // Minimum loading time
        };

        // Three.js Setup
        let scene, camera, renderer, loader3D, animationId;
        let isHovered = false;
        let isPaused = false;
        let progress = 0;

        function init3DLoader() {
            const canvas = document.getElementById('loader-canvas');
            const container = document.getElementById('loader-canvas-container');
            
            // Scene
            scene = new THREE.Scene();
            
            // Camera
            camera = new THREE.PerspectiveCamera(
                45,
                container.clientWidth / container.clientHeight,
                0.1,
                1000
            );
            camera.position.z = 5;
            
            // Renderer
            renderer = new THREE.WebGLRenderer({
                canvas: canvas,
                antialias: true,
                alpha: true,
                powerPreference: 'high-performance'
            });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            
            // Create 3D Loader Object (Torus Knot)
            const geometry = new THREE.TorusKnotGeometry(1, 0.3, 128, 32, 2, 3);
            
            // Material - Hybrid Metallic + Translucent
            const material = new THREE.MeshPhysicalMaterial({
                color: new THREE.Color(CONFIG.colorHex),
                metalness: CONFIG.metalness,
                roughness: CONFIG.roughness,
                transmission: 0.3, // Glass-like transparency
                thickness: 0.5,
                clearcoat: 1.0,
                clearcoatRoughness: 0.1,
                envMapIntensity: 1.5,
                side: THREE.DoubleSide
            });
            
            loader3D = new THREE.Mesh(geometry, material);
            scene.add(loader3D);
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight1 = new THREE.DirectionalLight(CONFIG.colorHex, 2);
            directionalLight1.position.set(5, 5, 5);
            scene.add(directionalLight1);
            
            const directionalLight2 = new THREE.DirectionalLight(CONFIG.accentColor, 1.5);
            directionalLight2.position.set(-5, -5, 5);
            scene.add(directionalLight2);
            
            const pointLight = new THREE.PointLight(0xffffff, 1, 100);
            pointLight.position.set(0, 0, 10);
            scene.add(pointLight);
            
            // Environment Map (Simple Cube Texture)
            const cubeTextureLoader = new THREE.CubeTextureLoader();
            const envMap = createSimpleEnvMap();
            scene.environment = envMap;
            material.envMap = envMap;
            
            // Hover Events
            canvas.addEventListener('mouseenter', () => {
                isHovered = true;
            });
            
            canvas.addEventListener('mouseleave', () => {
                isHovered = false;
            });
            
            // Handle Resize
            window.addEventListener('resize', onWindowResize);
            
            // Start Animation
            animate();
        }
        
        function createSimpleEnvMap() {
            const size = 512;
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');
            
            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, size);
            gradient.addColorStop(0, CONFIG.accentColor);
            gradient.addColorStop(1, CONFIG.colorHex);
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, size, size);
            
            const texture = new THREE.CanvasTexture(canvas);
            
            // Create cube texture from single texture
            const cubeRenderTarget = new THREE.WebGLCubeRenderTarget(size);
            return cubeRenderTarget.texture;
        }
        
        function animate() {
            animationId = requestAnimationFrame(animate);
            
            if (loader3D && !isPaused) {
                const time = Date.now() * 0.001;
                
                // Smooth rotation
                if (!isHovered) {
                    loader3D.rotation.x += 0.005 * CONFIG.rotationSpeed;
                    loader3D.rotation.y += 0.008 * CONFIG.rotationSpeed;
                }
                
                // Subtle bobbing
                loader3D.position.y = Math.sin(time * 0.5) * 0.1;
                
                // Subtle tilting
                loader3D.rotation.z = Math.sin(time * 0.3) * 0.1;
                
                // Pulse scale
                const scale = 1 + Math.sin(time * 2) * 0.05;
                loader3D.scale.set(scale, scale, scale);
            }
            
            renderer.render(scene, camera);
        }
        
        function onWindowResize() {
            const container = document.getElementById('loader-canvas-container');
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        }
        
        // Progress Simulation
        function simulateLoading() {
            const progressBar = document.getElementById('progress-bar');
            const progressPercentage = document.getElementById('progress-percentage');
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    // Hide loader after completion
                    setTimeout(hideLoader, 500);
                }
                
                progressBar.style.width = progress + '%';
                progressPercentage.textContent = Math.round(progress) + '%';
            }, 200);
        }
        
        // Hide Loader Function
        function hideLoader() {
            const loadingScreen = document.getElementById('loading-screen');
            const mainContent = document.getElementById('main-content');
            
            // Pause animation
            isPaused = true;
            
            // Fade out
            loadingScreen.classList.add('hidden');
            
            // Show main content
            setTimeout(() => {
                mainContent.style.display = 'block';
                
                // Cancel animation frame
                if (animationId) {
                    cancelAnimationFrame(animationId);
                }
                
                // Cleanup
                if (renderer) {
                    renderer.dispose();
                }
            }, 800);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            init3DLoader();
            
            // Simulate loading
            setTimeout(() => {
                simulateLoading();
            }, 500);
        });
        
        // Expose hideLoader globally for manual control
        window.hideLoader = hideLoader;
    </script>
</body>
</html>
